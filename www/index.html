<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HerboLive</title>

  <!-- Materialize CSS -->
  <link rel="stylesheet" href="css/materialize.min.css">

  <!-- Iconos de Material Design -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="css/style.css">

  <!-- Cordova (si aplica) -->
  <script src="cordova.js"></script>
</head>

<body class="green lighten-5">

  <!-- NAVBAR FIXED (Materialize) -->
  <div class="navbar-fixed">
    <nav class="green darken-2" role="navigation" aria-label="Main navigation">
      <div class="nav-wrapper container">
        <a href="#!" class="brand-logo valign-wrapper" style="display:flex; align-items:center;">
          <img src="img/logo.png" alt="Logo HerboLive" class="circle responsive-img"
            style="width:45px; height:45px; margin-right:10px;">
          HerboLive
        </a>



        <!-- Mobile sidenav trigger -->
        <a href="#" data-target="mobile-menu" class="sidenav-trigger show-on-medium-and-down" aria-label="Abrir menú"><i
            class="material-icons">menu</i></a>
      </div>
    </nav>
  </div>


  <!-- TABS WRAPPER (fijo justo debajo del navbar) -->
  <div id="tabs-wrapper" class="tabs-wrapper">
    <div class="container">
      <div class="row" style="margin:0;">
        <div class="col s12">
          <ul id="main-tabs" class="tabs tabs-fixed-width">
            <li class="tab col s4"><a class="active" href="#intro">Introducción</a></li>
            <li class="tab col s4"><a href="#buscar">Buscar</a></li>
            <li class="tab col s4"><a href="#todas">Todas</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN: ajusta padding-top vía variable CSS --top-offset calculada por JS -->
  <main class="main-with-fixed-tabs">
    <div class="container" id="app-root" style="padding-top: 1.5rem;">
      <!-- INTRO -->
      <div id="intro" class="col s12">
        <div class="card white z-depth-2">
          <div class="card-content">
            <span class="card-title green-text text-darken-3">Bienvenido a HerboLive</span>
            <p>HerboLive es una demostración de una futura aplicación dedicada al bienestar natural y al conocimiento de
              las plantas medicinales. Nuestro objetivo es ayudarte a cuidar de tu salud a través de los recursos que la
              naturaleza nos ofrece.
              <br>
              En esta versión preliminar podrás explorar una selección de plantas con propiedades beneficiosas para la
              salud. Por motivos de rendimiento, hemos limitado temporalmente la cantidad de datos disponibles para
              ofrecerte una experiencia más fluida.
              <br>
              Seguimos trabajando para ampliar el catálogo y optimizar el funcionamiento de la aplicación. Muy pronto,
              HerboLive ofrecerá una base de datos más completa, con información detallada y nuevas herramientas para
              que puedas descubrir, aprender y cuidar de ti de forma natural.
            </p>
          </div>
        </div>
      </div>

      <!-- BUSCAR -->
      <div id="buscar" class="col s12">
        <div class="row" style="margin-bottom:8px;">
          <div class="input-field col s9" style="margin:0;">
            <input id="search-input" type="text" placeholder="Buscar planta por nombre común, científico o familia">
          </div>
          <div class="col s3" style="display:flex; align-items:flex-end; padding-left:0;">
            <button id="search-btn" class="btn green darken-2 waves-effect waves-light" style="width:100%;">
              <i class="material-icons left">search</i>Buscar
            </button>
          </div>
        </div>

        <div id="search-results-container" class="row" style="min-height:220px;"></div>

        <div id="pagination-search" class="center-align pagination-sticky"
          style="display:none; margin-top:12px; position: sticky; bottom: 0; background: rgba(250,250,250,0.95); padding:8px 0; z-index:10;">
          <div class="pagination-row">
            <button id="prev-page-search" class="btn-flat green-text" title="Página anterior">
              <i class="material-icons left">chevron_left</i>
            </button>
            <span id="current-page-search" style="margin: 0 10px;">Página 1</span>
            <button id="next-page-search" class="btn-flat green-text" title="Página siguiente">
              <i class="material-icons right">chevron_right</i>
            </button>
          </div>
        </div>
      </div>

      <!-- TODAS -->
      <div id="todas" class="col s12">
        <div id="plants-container" class="row" style="min-height:220px;"></div>

        <div id="pagination-all" class="center-align"
          style="display:none; margin-top:12px; position: sticky; bottom: 0; background: rgba(250,250,250,0.95); padding:8px 0; z-index:10;">
          <button id="prev-page-all" class="btn-flat green-text" title="Página anterior">
            <i class="material-icons left">chevron_left</i>
          </button>
          <span id="current-page-all" style="margin: 0 10px;">Página 1</span>
          <button id="next-page-all" class="btn-flat green-text" title="Página siguiente">
            <i class="material-icons right">chevron_right</i>
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="page-footer green lighten-4" style="box-shadow:none;">
    <div class="container">
      <div class="row">
        <div class="col s12">
          <span class="black-text">© HerboLive</span>
        </div>
      </div>
    </div>
  </footer>

  <!-- Inicializadores y ajuste dinámico para calcular --top-offset -->
  <script>
    // Calcula la variable CSS --top-offset para reservar espacio al nav + tabs fijas
    (function () {
      function updateTopOffset() {
        const nav = document.querySelector('nav');
        const tabsWrapper = document.getElementById('tabs-wrapper');
        const root = document.documentElement;
        let navH = 0, tabsH = 0;
        if (nav) navH = Math.ceil(nav.getBoundingClientRect().height);
        if (tabsWrapper) tabsH = Math.ceil(tabsWrapper.getBoundingClientRect().height);
        const total = navH + tabsH;
        root.style.setProperty('--top-offset', total + 'px');
        // también aplicamos padding-top del main por compatibilidad
        const main = document.querySelector('.main-with-fixed-tabs');
        if (main) main.style.paddingTop = total + 'px';
        // garantizar que tabsWrapper está justo debajo del nav
        if (tabsWrapper) tabsWrapper.style.top = navH + 'px';
      }

      // run on load and resize
      window.addEventListener('load', () => { updateTopOffset(); setTimeout(updateTopOffset, 250); });
      window.addEventListener('resize', () => { updateTopOffset(); });

      // If content changes size dynamically, you can call updateTopOffset() after render
      window.HerboLive = window.HerboLive || {};
      window.HerboLive.updateTopOffset = updateTopOffset;
    })();
  </script>

  <!-- Crear namespace global si no existe (necesario para main.js antiguo) -->
  <script>window.HerboLive = window.HerboLive || {};</script>

  <!-- -------- SCRIPTS: orden recomendado -------- -->
  <!-- Materialize JS -->
  <script src="js/materialize.min.js" defer></script>

  <!-- Archivos de datos / configuración / utilidades -->
  <script src="js/config.js" defer></script>
  <script src="js/utils.js" defer></script>
  <script src="js/csv.js" defer></script>

  <!-- API / carga / renderizado -->
  <script src="js/api.js" defer></script>
  <script src="js/loader.js" defer></script>
  <script src="js/render.js" defer></script>

  <!-- UI / modal / búsqueda / debug -->
  <script src="js/modal.js" defer></script>
  <script src="js/search.js" defer></script>
  <script src="js/debug.js" defer></script>

  <!-- entrypoint: main.js (último) -->
  <script src="js/main.js" defer></script>

  <!-- starter: intenta llamar a window.initApp() si existe (compatibilidad) -->
  <script>
    (function () {
      function callInitApp() {
        try {
          if (typeof window.initApp === 'function') { window.initApp(); return; }
          if (typeof window.main === 'function') { window.main(); return; }
        } catch (err) {
          console.error('Error al arrancar la app:', err);
        }
      }

      document.addEventListener('deviceready', function () {
        if (window.M) {
          // inicializar tabs y sidenav si Materialize está cargado
          const tabs = document.querySelectorAll('.tabs');
          M.Tabs.init(tabs, {});
          const sidenavs = document.querySelectorAll('.sidenav');
          M.Sidenav.init(sidenavs, {});
        }
        callInitApp();
      }, false);

      document.addEventListener('DOMContentLoaded', function () {
        if (window.M) {
          const tabs = document.querySelectorAll('.tabs');
          M.Tabs.init(tabs, {});
          const sidenavs = document.querySelectorAll('.sidenav');
          M.Sidenav.init(sidenavs, {});
        }
        callInitApp();
      });
    })();
  </script>

</body>

</html>